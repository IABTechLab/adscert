syntax = "proto3";

package api;

option go_package = "github.com/IABTechLab/adscert/internal/api";

message AuthenticatedConnectionSignatureParams {
    string invocation_hostname = 1;
    string destination_url = 2;
    string request_body = 3;
}

message AuthenticatedConnectionSignature {
    repeated string signature_messages = 1;
}

message AuthenticatedConnectionVerification {
    bool body_valid = 1;
    bool url_valid = 2;
}

service AdsCert {
    rpc SignAuthenticatedConnection(AuthenticatedConnectionSignatureParams) returns (AuthenticatedConnectionSignature) {}
    rpc VerifyAuthenticatedConnection(AuthenticatedConnectionSignatureParams) returns (AuthenticatedConnectionVerification){}
}
